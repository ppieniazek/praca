{% load i18n %}
{% partialdef project_detail_modal %}
<div id="modal-content"
     class="modal-box max-w-2xl bg-base-100 p-0 overflow-hidden border border-base-300 shadow-2xl max-h-[90vh] flex flex-col">
  <div class="p-6 overflow-y-auto flex-grow">
    <div class="flex justify-between items-start mb-6">
      <div class="flex flex-col">
        <h3 class="font-bold text-2xl text-base-content">{{ project.name }}</h3>
        <p class="text-xs opacity-50 flex items-center gap-1 mt-1">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" /></svg>
          {{ project.address|default:"Brak adresu" }}
        </p>
      </div>
      <button type="button" class="btn btn-ghost btn-sm btn-circle" data-on:click="$is_modal_open = false">✕</button>
    </div>

    <div class="flex gap-2 mb-6">
        {% if project.status == 'PLANNED' %}
          <div class="badge badge-info badge-sm font-bold">{% trans "Planowany" %}</div>
        {% elif project.status == 'ACTIVE' %}
          <div class="badge badge-success badge-sm font-bold">{% trans "Aktywny" %}</div>
        {% else %}
          <div class="badge badge-ghost badge-sm font-bold opacity-50">{% trans "Zakończony" %}</div>
        {% endif %}
    </div>

    <div class="grid grid-cols-2 gap-4 mb-8">
      <div class="bg-base-200/50 p-4 rounded-xl border border-base-300">
        <h3 class="text-xs font-bold opacity-70 mb-1 uppercase tracking-wider">{% trans "Całkowite Wydatki" %}</h3>
        <div class="text-xl font-mono text-error font-black">
          {{ project.total_expense|default:"0"|floatformat:2 }} <span class="text-xs opacity-50 font-sans font-normal">PLN</span>
        </div>
      </div>
      <div class="bg-base-200/50 p-4 rounded-xl border border-base-300">
        <h3 class="text-xs font-bold opacity-70 mb-1 uppercase tracking-wider">{% trans "Roboczogodziny" %}</h3>
        <div class="text-xl font-mono">
          {{ project.total_hours|default:"0"|floatformat:0 }} <span class="text-xs opacity-50 font-sans font-normal">h</span>
        </div>
      </div>
    </div>

    <h3 class="font-bold text-lg mb-4 text-base-content border-b border-base-200 pb-2">{% trans "Historia (Miesiące)" %}</h3>
    <div class="overflow-x-auto bg-base-100 rounded-xl shadow-sm border border-base-300">
      <table class="table table-zebra w-full text-sm">
        <thead>
          <tr class="bg-base-200/50 text-base-content/70">
            <th class="uppercase text-[10px] tracking-wider">{% trans "Miesiąc" %}</th>
            <th class="text-right uppercase text-[10px] tracking-wider">{% trans "Roboczogodziny" %}</th>
            <th class="text-right uppercase text-[10px] tracking-wider">{% trans "Wydatki" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for row in monthly_summary %}
            <tr class="hover:bg-base-200/30 transition-colors">
              <td class="font-bold capitalize">{{ row.month|date:"F Y" }}</td>
              <td class="text-right font-mono">
                {{ row.total_hours|default:"0"|floatformat:0 }} <span class="text-[10px] font-normal opacity-50">h</span>
              </td>
              <td class="text-right font-mono font-bold text-error">
                {{ row.total_expense|default:"0"|floatformat:2 }} <span class="text-[10px] font-normal opacity-50">PLN</span>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="3" class="text-center py-8 opacity-40 italic">
                {% trans "Brak zarejestrowanej historii dla tego projektu." %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="modal-action mt-6 pt-4 border-t border-base-200">
      <button type="button" class="btn btn-ghost w-full" data-on:click="$is_modal_open = false">{% trans "Zamknij" %}</button>
    </div>
  </div>
</div>
{% endpartialdef %}
